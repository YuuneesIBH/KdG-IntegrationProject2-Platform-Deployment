apiVersion: v1
kind: Namespace
metadata:
  name: bordspelplatform-8
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: platform-config
  namespace: bordspelplatform-8
data:
  # Platform Frontend Environment Variables
  VITE_KC_URL: "https://dampf-app.com/auth"
  VITE_KC_REALM: "boardgame-platform"
  VITE_KC_CLIENT_ID: "react-client"
  # Keycloak URLs for frontends
  KEYCLOAK_URL: "https://dampf-app.com/auth"
  KEYCLOAK_REALM: "boardgame-platform"
  KEYCLOAK_CLIENT_ID: "react-client"
  # Database Configuration
  DB_HOST: "postgres-service.bordspelplatform-8.svc.cluster.local"
  DB_PORT: "5432"
  DB_USER: "user"
  # RabbitMQ Configuration
  RABBIT_HOST: "rabbitmq-service.bordspelplatform-8.svc.cluster.local"
  RABBIT_PORT: "5672"
  RABBIT_USER: "user"
  # Redis Configuration
  REDIS_HOST: "redis-service.bordspelplatform-8.svc.cluster.local"
  REDIS_PORT: "6379"
  # Keycloak Configuration (Backend JWT)
  JWK_SET_URI: "http://keycloak-service.bordspelplatform-8.svc.cluster.local:8180/auth/realms/boardgame-platform/protocol/openid-connect/certs"
  TOKEN_URI: "http://keycloak-service.bordspelplatform-8.svc.cluster.local:8180/auth/realms/boardgame-platform/protocol/openid-connect/token"
  # Google Cloud Storage (optional)
  GCP_PROJECT_ID: "ip2-devops4-480317"
  GCS_BUCKET_NAME: "dampf-app-team8-game-bucket"
  GCP_CREDENTIALS_LOCATION: ""
  GOOGLE_APPLICATION_CREDENTIALS: ""
  # Database Schema Management
  DDL_AUTO: "update"
  SQL_INIT_MODE: "always"
  DEFER_DATASOURCE_INIT: "true"
  # Stripe Configuration
  STRIPE_SUCCESS_URL: "https://dampf-app.com/store/coins?purchase=success"
  STRIPE_CANCEL_URL: "https://dampf-app.com/store/coins?purchase=cancelled"
  # Platform Service URLs
  PLATFORM_SERVICE_URL: "http://platform-backend-service.bordspelplatform-8.svc.cluster.local:8080"
  PLATFORM_API_URL: "/api/platform"
  GAME_API_URL: "/api/games"
  # Blokus Game URLs
  BLOKUS_BACKEND_URL: "http://blokus-backend-service.bordspelplatform-8.svc.cluster.local:8080"
  AI_SERVICE_URL: "http://ai-service.bordspelplatform-8.svc.cluster.local:8000"
  # Keycloak Config
  KC_DB: "mysql"
  KC_DB_URL_HOST: "mysql-service.bordspelplatform-8.svc.cluster.local"
  KC_DB_URL_DATABASE: "keycloak"
  KC_DB_URL: "jdbc:mysql://mysql-service.bordspelplatform-8.svc.cluster.local:3306/keycloak"
  KC_DB_USERNAME: "keycloak"
  KC_PROXY_HEADERS: "xforwarded"
  KC_HOSTNAME_STRICT: "false"
  KC_HTTP_RELATIVE_PATH: "/auth"
  KC_HTTP_PORT: "8080"
  KC_HOSTNAME_URL: "https://dampf-app.com/auth"
  KC_HOSTNAME_ADMIN_URL: "https://dampf-app.com/auth/admin"
  KC_HOSTNAME: "dampf-app.com"
  KC_HOSTNAME_PORT: "443"
  KC_HTTP_ENABLED: "true"
  KC_PROXY: "edge"
---
apiVersion: v1
kind: Secret
metadata:
  name: platform-secrets
  namespace: bordspelplatform-8
type: Opaque
stringData:
  DB_PASS: "password"
  RABBIT_PASS: "password"
  PLATFORM_CLIENT_SECRET: "your-platform-client-secret"
  BLOKUS_CLIENT_SECRET: "your-blokus-client-secret"
  KEYCLOAK_ADMIN: "admin"
  KEYCLOAK_ADMIN_PASSWORD: "admin"
  KC_DB_PASSWORD: "password"
  PROXY_USER: "public"
  PROXY_PASSWORD: "public"
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: postgres-pvc
  namespace: bordspelplatform-8
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 20Gi
  storageClassName: standard
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: mysql-pvc
  namespace: bordspelplatform-8
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 10Gi
  storageClassName: standard
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: redis-pvc
  namespace: bordspelplatform-8
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
  storageClassName: standard
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: rabbitmq-pvc
  namespace: bordspelplatform-8
spec:
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 5Gi
  storageClassName: standard
